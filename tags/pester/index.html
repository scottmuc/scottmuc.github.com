<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<title>Pester</title>
	
	<meta name="author" content="map[email:scottmuc@gmail.com name:Scott Muc]">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="alternate" type="application/rss+xml" href="http://feeds.scottmuc.com/scottmucblog" title="More Muc Than You Can Handle">
</head>
<body>
	<header>
		<h1>
			<a href="https://scottmuc.com/">More Muc Than You Can Handle</a>
		</h1>
	</header>

	
	<main>
		
		<div>
			<h1>Pester</h1>
			
		</div>
		

		
			<article>
	<h1><a href="https://scottmuc.com/blog/growing-an-open-source-project-the-pester-story/">Growing an Open Source Project: The Pester Story</a></h1>
	<time>07.08.2014 17:50</time>
	
	<a href="/tags/pester">pester</a>
	
	<div>
		<p><a href="https://github.com/pester/Pester"><figure><img src="/blog/growing-an-open-source-project-the-pester-story/github-pester.png" width="800">
</figure>
</a></p>
<h3 id="in-the-beginning">In the Beginning</h3>
<p>In 2010 I was on a project that focused on build and release software for a bunch of .Net projects (and a few Java
projects). Our &ldquo;glue&rdquo; was written in PowerShell because of the wonderful remoting capabilities and it&rsquo;s integration with
Windows automation. Our code was untested and our code base was growing over time because our tools proved to be useful and
we were getting more and more feedback. Thus, the code required change more frequently. Without the safety net of tests
for the most basic logic, our feedback loop was slow as it required us to run builds and deploys to adequately cover our
bases.</p>
		
			<a href="https://scottmuc.com/blog/growing-an-open-source-project-the-pester-story/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://scottmuc.com/blog/testing-powershell-code-that-talks-to-clr-objects/">Testing Powershell Code That Talks to CLR Objects</a></h1>
	<time>05.06.2014 17:39</time>
	
	<a href="/tags/pester">pester</a>
	
	<div>
		<p>Several months ago someone posted an excellent question on the <a href="https://groups.google.com/forum/#!topic/pester/Y8UzSiNlcSE">Pester Group</a> about a certain problem area
in testing PowerShell with <a href="https://github.com/pester/Pester">Pester</a>.  He brings up a relevant example of the difficulties that can occur when writing tests
is done afterwards. It also reveals a missing feature of Pester.</p>
<p>First let me display the code that needed tests:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Add-Type -Path (Join-Path -Path $psScriptRoot <span style="color:#e6db74">&#34;Renci.SshNet.dll&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-FromSFtp {
</span></span><span style="display:flex;"><span>    $fileList=$null
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        $sftp=New-Object Renci.SshNet.SftpClient(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>,<span style="color:#e6db74">&#34;test&#34;</span>,<span style="color:#e6db74">&#34;test&#34;</span>)
</span></span><span style="display:flex;"><span>        $sftp.Connect()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>($sftp.IsConnected) {
</span></span><span style="display:flex;"><span>            $sftp.ChangeDirectory(<span style="color:#e6db74">&#34;/test&#34;</span>)
</span></span><span style="display:flex;"><span>            $fileList=$sftp.ListDirectory(<span style="color:#e6db74">&#34;.&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $fileList
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> [<span style="color:#66d9ef">Exception</span>] {
</span></span><span style="display:flex;"><span>        Write-Host $_.Exception.ToString()
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(($sftp <span style="color:#f92672">-ne</span> $null) <span style="color:#f92672">-and</span> ($sftp.IsConnected)) {
</span></span><span style="display:flex;"><span>            $sftp.Disconnect()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Here are a couple reasons why this code is difficult to test:</p>
		
			<a href="https://scottmuc.com/blog/testing-powershell-code-that-talks-to-clr-objects/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://scottmuc.com/blog/powershell-pester-2-and-1-dot-2-released/">PowerShell Pester 2 and 1.2 Released!</a></h1>
	<time>02.02.2013 15:34</time>
	
	<a href="/tags/pester">pester</a>
	
	<div>
		<p>After a whirlwind of activity on the <a href="https://github.com/pester/Pester">Pester</a> codebase I&rsquo;m happy to announce the latest release of Pester. Versions 1.2 and 2 are identical feature wise except for one subtle difference that I&rsquo;ll get into soon.</p>
<h2 id="new-expectation-and-matcher-syntax">New Expectation and Matcher Syntax</h2>
<p>In prior versions of Pester, we have the dot notation expectation and matcher syntax</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$some_string.should.be(<span style="color:#e6db74">&#34;some value&#34;</span>)
</span></span></code></pre></div><p>This required some <a href="https://github.com/pester/Pester/blob/bf3afbf330808cfee8a26665a77c9388ae432286/ObjectAdaptations/types.ps1xml">clever and downright nasty hacks</a> to the PowerShell runtime. This created a <a href="https://github.com/pester/Pester/issues/19">few</a> <a href="https://github.com/pester/Pester/issues/27">issues</a> for some users and I wanted to get that fixed. It turned out the extension on Object was the root issue so I investigated a pipeline based expectation syntax. Here is the result:</p>
		
			<a href="https://scottmuc.com/blog/powershell-pester-2-and-1-dot-2-released/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://scottmuc.com/blog/powershell-bdd-testing-pester-screencast/">PowerShell BDD Testing - Pester Screencast</a></h1>
	<time>25.08.2011 11:16</time>
	
	<a href="/tags/pester">pester</a>
	
	<div>
		<p>A few months ago I posted a simple tutorial on how to use <a href="/blog/pester-bdd-for-the-system-administrator/">Pester (a powershell bdd testing framework)</a>. I&rsquo;m starting to practice the making of screencasts so I thought I would add some audio/visual to the blog post. I start rambling in the last 5 minutes so I won&rsquo;t feel insulted if you stop paying attention after that part.</p>
<p>Also, I want to thank <a href="https://github.com/manojlds">Manoj Mahalingam</a> and <a href="http://blog.martin.aatmaa.net/">Martin Aatmaa</a> for their feedback and contributions!</p>
		
			<a href="https://scottmuc.com/blog/powershell-bdd-testing-pester-screencast/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://scottmuc.com/blog/pester-powershell-bdd-style-testing-for-the-system-administrator/">Pester - PowerShell BDD Style Testing For The System Administrator</a></h1>
	<time>11.05.2011 20:05</time>
	
	<a href="/tags/pester">pester</a>
	
	<div>
		<p>Hi there and welcome to my demo of Pester, a BDD style testing framework for Powershell. The creation of Pester came out of the desire to test some build/deployment infrastructure we were creating for a project. We wrote nearly all the code without tests and it came to bite us in the end. I wanted to find a way ensure these problems didn&rsquo;t happen again as well as provide some code coverage to give new entrants to the codebase some confidence that they won&rsquo;t break everything.</p>
		
			<a href="https://scottmuc.com/blog/pester-powershell-bdd-style-testing-for-the-system-administrator/">Read more...</a>
		
	</div>
</article>

		
		<div>

1 of 1

</div>

	</main>


	<footer>
		<p>Copyright &copy; 2025 Scott Muc. Content licensed under
			<a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
			Code snippets under <a href="https://opensource.org/licenses/MIT">MIT License</a>.
		</p>
	</footer>
</body>
</html>
